<div class="form-horizontal">
  <div class="form-group" ng-if="$ctrl.displayField('waitForCompletion')">
    <div class="col-md-8 col-md-offset-1">
      <div class="checkbox pull-left">
        <stage-config-field label="$ctrl.stage.url">
        </stage-config-field>
        <stage-config-field label="$ctrl.stage.payload">
        </stage-config-field>
        <label>
          <input type="checkbox"
                 name="waitForCompletion"
                 ng-model="$ctrl.viewState.waitForCompletion"
                 ng-change="$ctrl.waitForCompletionChanged()"/>
          <strong>Wait for completion</strong>
          <help-field key="pipeline.config.webhook.waitForCompletion"></help-field>
        </label>
      </div>
    </div>
  </div>
  <div ng-class="{collapse: $ctrl.viewState.waitForCompletion !== true, 'collapse.in': !$ctrl.viewState.waitForCompletion === true}">
    <div class="form-group" ng-if="$ctrl.displayField('statusUrlResolution')">
      <div class="col-md-3 sm-label-right">Status URL</div>
      <div class="col-md-9 radio">
        <label>
          <input type="radio"
                 ng-model="$ctrl.viewState.statusUrlResolution"
                 ng-change="$ctrl.statusUrlResolutionChanged()"
                 value="getMethod"
                 id="statusUrlResolutionIsGetMethod"/>
          GET method against Gatekeeper URL
          <help-field key="pipeline.config.webhook.statusUrlResolutionIsGetMethod"></help-field>
        </label>
      </div>
      <div class="col-md-9 col-md-offset-3 radio">
        <label>
          <input type="radio"
                 ng-model="$ctrl.viewState.statusUrlResolution"
                 ng-change="$ctrl.statusUrlResolutionChanged()"
                 value="locationHeader"
                 id="statusUrlResolutionIsLocationHeader"/>
          From the Location header
          <help-field key="pipeline.config.webhook.statusUrlResolutionIsLocationHeader"></help-field>
        </label>
      </div>
      <div class="col-md-9 col-md-offset-3 radio">
        <label>
          <input type="radio"
                 ng-model="$ctrl.viewState.statusUrlResolution"
                 ng-change="$ctrl.statusUrlResolutionChanged()"
                 value="webhookResponse"
                 id="statusUrlResolutionIsWebhookResponse"/>
          From webhook's response
          <help-field key="pipeline.config.webhook.useStatusUrlFromLocationHeaderFalse"></help-field>
        </label>
      </div>
      <div class="form-group" ng-if="$ctrl.viewState.statusUrlResolution === 'webhookResponse' && $ctrl.displayField('statusUrlJsonPath')">
        <div class="col-md-offset-3">
          <stage-config-field label="Status URL path" help-key="pipeline.config.webhook.statusUrlJsonPath">
            <input type="text"
                   class="form-control input-sm"
                   ng-model="$ctrl.stage.statusUrlJsonPath"
                   required/>
          </stage-config-field>
        </div>
      </div>
    </div>
    <stage-config-field label="Status JsonPath"
                        help-key="pipeline.config.webhook.statusJsonPath"
                        ng-if="$ctrl.displayField('statusJsonPath')">
      <input type="text"
             class="form-control input-sm"
             ng-model="$ctrl.stage.statusJsonPath"/>
    </stage-config-field>
    <stage-config-field label="Progress location"
                        help-key="pipeline.config.webhook.progressJsonPath"
                        ng-if="$ctrl.displayField('progressJsonPath')">
      <input type="text"
             class="form-control input-sm"
             ng-model="$ctrl.stage.progressJsonPath"/>
    </stage-config-field>
    <stage-config-field label="SUCCESS status mapping"
                        help-key="pipeline.config.webhook.successStatuses"
                        ng-if="$ctrl.displayField('successStatuses')">
      <input type="text"
             class="form-control input-sm"
             ng-model="$ctrl.stage.successStatuses"/>
    </stage-config-field>
    <stage-config-field label="CANCELED status mapping"
                        help-key="pipeline.config.webhook.canceledStatuses"
                        ng-if="$ctrl.displayField('canceledStatuses')">
      <input type="text"
             class="form-control input-sm"
             ng-model="$ctrl.stage.canceledStatuses"/>
    </stage-config-field>
    <stage-config-field label="TERMINAL status mapping"
                        help-key="pipeline.config.webhook.terminalStatuses"
                        ng-if="$ctrl.displayField('terminalStatuses')">
      <input type="text"
             class="form-control input-sm"
             ng-model="$ctrl.stage.terminalStatuses"/>
    </stage-config-field>
  </div>
</div>
